!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).ku4es_security={})}(this,(function(e){"use strict";function n(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function t(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var i=require("jsonwebtoken"),o=i.verify,r=i.sign,a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;n(this,e),this._payload=t,i&&(this._payload.__signature__=i)}var i,a,u;return i=e,u=[{key:"verify",value:function(n,t,i){return new Promise((function(r,a){o(n,t,(function(n,t){n&&a(n),t.__signature__&&t.__signature__!==i?a(new Error("Invalid signature")):r(new e(t))}))}))}}],(a=[{key:"read",value:function(e){return e?this._payload[e]:Object.assign({},this._payload)}},{key:"write",value:function(e,n){return this._payload[e]=n,this}},{key:"remove",value:function(e){return delete this._payload[e],this}},{key:"sign",value:function(e){var n=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"RS256";return new Promise((function(i,o){r(n._payload,e,{algorithm:t},(function(e,n){return e?o(e):i(n)}))}))}}])&&t(i.prototype,a),u&&t(i,u),e}();e.Token=a,Object.defineProperty(e,"__esModule",{value:!0})}));
